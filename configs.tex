%!TEX root = main.tex
\usepackage[T1]{fontenc}
\usepackage[spanish]{babel}
\usepackage{textcomp}
\usepackage{url}
\usepackage{graphicx}
\usepackage{float}
\usepackage{booktabs}
\usepackage{enumitem}
% \usepackage{parskip}
\usepackage{emptypage}
\usepackage{subcaption}
\usepackage{multicol}
\usepackage[usenames,dvipsnames]{xcolor}
\usepackage{amsmath, amsfonts, mathtools, amsthm, amssymb}
\usepackage{mathrsfs}
\usepackage{animate}
\usepackage{cancel}
\usepackage{bm}
\usepackage{enumitem}
\usepackage[breaklinks = true]{hyperref}
\usepackage{lipsum}

\newcommand\N{\ensuremath{\mathbb{N}}}
\newcommand\R{\ensuremath{\mathbb{R}}}
\newcommand\Z{\ensuremath{\mathbb{Z}}}
\renewcommand\O{\ensuremath{\emptyset}}
\newcommand\Q{\ensuremath{\mathbb{Q}}}
\newcommand\C{\ensuremath{\mathbb{C}}}
\usepackage{systeme}

% correct color problem syntax (XD)
\definecolor{correct}{HTML}{009900}
\newcommand\correct[2]{\ensuremath{\:}{\color{red}{#1}}\ensuremath{\to }{\color{correct}{#2}}\ensuremath{\:}}
\newcommand\green[1]{{\color{correct}{#1}}}

% horizontal rule
\newcommand\hr{
    \noindent\rule[0.5ex]{\linewidth}{0.5pt}
}
\newcommand\mat[1]{\mathbf{#1}}
% tikz
\usepackage{tikz}
\usepackage{tikz-cd}
\usetikzlibrary{intersections, angles, quotes, calc, positioning}
\usetikzlibrary{arrows.meta,shapes.misc,shadows,calc}
\usepackage{pgfplots}
\pgfplotsset{compat=1.13}
\tikzset{
    force/.style={thick, {Circle[length=2pt]}-stealth, shorten <=-1pt}
}

% Tcolorboxes
\makeatother
\usepackage{thmtools}
\usepackage[framemethod=TikZ]{mdframed}
\mdfsetup{skipabove=1em,skipbelow=1em}


\theoremstyle{definition}

\declaretheoremstyle[
    headfont=\bfseries\sffamily\color{ForestGreen!70!black}, bodyfont=\normalfont,
    mdframed={
        linewidth=2pt,
        rightline=false, topline=false, bottomline=false,
        linecolor=ForestGreen, backgroundcolor=ForestGreen!5,
    }
]{thmgreenbox}

\declaretheoremstyle[
    headfont=\bfseries\sffamily\color{NavyBlue!70!black}, bodyfont=\normalfont,
    mdframed={
        linewidth=2pt,
        rightline=false, topline=false, bottomline=false,
        linecolor=NavyBlue, backgroundcolor=NavyBlue!5,
    }
]{thmbluebox}

\declaretheoremstyle[
    headfont=\bfseries\sffamily\color{NavyBlue!70!black}, bodyfont=\normalfont,
    mdframed={
        linewidth=2pt,
        rightline=false, topline=false, bottomline=false,
        linecolor=NavyBlue
    }
]{thmblueline}

\declaretheoremstyle[
    headfont=\bfseries\sffamily\color{RawSienna!70!black}, bodyfont=\normalfont,
    mdframed={
        linewidth=2pt,
        rightline=false, topline=false, bottomline=false,
        linecolor=RawSienna, backgroundcolor=RawSienna!5,
    }
]{thmredbox}

\declaretheoremstyle[
    headfont=\bfseries\sffamily\color{RawSienna!70!black}, bodyfont=\normalfont,
    numbered=no,
    mdframed={
        linewidth=2pt,
        rightline=false, topline=false, bottomline=false,
        linecolor=RawSienna, backgroundcolor=RawSienna!1,
    },
    qed=\qedsymbol
]{thmproofbox}

\declaretheoremstyle[
    headfont=\bfseries\sffamily\color{NavyBlue!70!black}, bodyfont=\normalfont,
    numbered=no,
    mdframed={
        linewidth=2pt,
        rightline=false, topline=false, bottomline=false,
        linecolor=NavyBlue, backgroundcolor=NavyBlue!1,
    },
]{thmexplanationbox}

\declaretheoremstyle[
    headfont=\bfseries\sffamily\color{NavyBlue!70!black}, bodyfont=\normalfont,
    mdframed={
        linewidth=2.5pt,
        rightline=false, topline=false, bottomline=false,
        linecolor=NavyBlue, backgroundcolor=NavyBlue!3,
    }
]{mblue}



\declaretheorem[style=thmgreenbox, name=Definición]{definition}
\declaretheorem[style=thmbluebox, numbered=no, name=Ejemplo]{eg}
\declaretheorem[style=thmredbox, name=Proposición]{prop}
\declaretheorem[style=thmredbox, name=Teorema]{theorem}
\declaretheorem[style=thmredbox, name=Lema]{lemma}
\declaretheorem[style=thmredbox, numbered=no, name=Corolario]{corollary}

\declaretheorem[style=thmproofbox, name=\textit{Demostración}]{replacementproof}
\renewenvironment{proof}[1][\proofname]{\vspace{-10pt}\begin{replacementproof}}{\end{replacementproof}}

\declaretheorem[style=thmblueline, numbered=no, name=Nota]{note}
\declaretheorem[style=thmblueline, numbered=no,name=]{temp}


\newcommand{\bb}[1]{\mathbb{#1}}

%%%%%%
\usepackage{newunicodechar}
\usepackage{fontspec}

\setmainfont{CMU Serif}
\setsansfont{CMU Sans Serif}
\setmonofont{CMU Typewriter Text}

\newfontface{\pencilfont}{DejaVu Sans}[Scale=MatchUppercase,AutoFakeBold=2.5]

\newunicodechar{✎}{{\pencilfont ✎}}
\newunicodechar{☠}{{\pencilfont ☠}}

\usepackage{geometry}
 \geometry{
 a4paper,
 total={170mm,245mm},
 left=20mm,
 top=20mm,
 }

\usepackage{indentfirst}

\usepackage[most]{tcolorbox}
\tcbuselibrary{most}

\tcbset {
  base/.style={
    arc=7mm, 
    bottomtitle=0.5mm,
    boxrule=0mm,
    colbacktitle=black!90!white, 
    coltitle=white, 
    fonttitle=\bfseries, 
    left=2.5mm,
    leftrule=1mm,
    right=3.5mm,
    title={#1},
    toptitle=0.75mm, 
  }
}


\newtcolorbox{subbox}[1]{
  colframe=black!93!white,
  base={#1}
}

\newtcolorbox{arrowbox}[1]{enhanced,title=#1,colbacktitle=NavyBlue!80!white,
  coltitle=white,attach boxed title to top left={xshift=-3mm, yshift=-0.5mm, -},boxrule=0pt,
  after skip=1cm,before skip=1cm,right skip=0cm,breakable,fonttitle=\bfseries,
  toprule=0pt,bottomrule=0pt,rightrule=0pt,leftrule=3pt,colframe=NavyBlue,colback=NavyBlue!3!white,arc=0mm,
  skin=enhancedlast jigsaw,sharp corners,boxed title style={
    frame code={ 
      \fill[NavyBlue!80!white](frame.south west)--(frame.north west)--(frame.north east)--
      ([xshift=3mm]frame.east)--(frame.south east)--cycle;
      \draw[line width=1mm,NavyBlue!80!white]([xshift=2mm]frame.north east)--([xshift=5mm]frame.east)--
      ([xshift=2mm]frame.south east);
      \fill[NavyBlue!80!white](frame.south west)--+(4mm,-2mm)--+(4mm,2mm)--cycle;
    }
  }
}


\usepackage{environ}

\NewEnviron{basedtikz}[1][]{%
  \begin{temp}
    \noindent\textbf{}\par
    \centering
    \BODY
  \end{temp}
}

\usepackage{pythontex}
\usepackage{epigraph}



%titlepage


\renewcommand\epigraphflush{flushright}
\renewcommand\epigraphsize{\normalsize}
\setlength\epigraphwidth{0.7\textwidth}

\definecolor{titlepagecolor}{cmyk}{1,.60,0,.40}

\DeclareFixedFont{\titlefont}{T1}{ppl}{b}{it}{0.5in}

\makeatletter                       
\def\printauthor{%                  
    {\large \@author}}              
\makeatother
\author{%
    Edgar Santiago Ochoa \\
    \texttt{eochoaq@unal.edu.co}\vspace{20pt} \\
    Mateo Andrés Manosalva\\
    \texttt{mmanosalva@unal.edu.co}
    }

% The following code is borrowed from: https://tex.stackexchange.com/a/86310/10898

\newcommand\titlepagedecoration{%
\begin{tikzpicture}[remember picture,overlay,shorten >= -10pt]

\coordinate (aux1) at ([yshift=-15pt]current page.north east);
\coordinate (aux2) at ([yshift=-410pt]current page.north east);
\coordinate (aux3) at ([xshift=-4.5cm]current page.north east);
\coordinate (aux4) at ([yshift=-150pt]current page.north east);

\begin{scope}[titlepagecolor!40,line width=12pt,rounded corners=12pt]
\draw
  (aux1) -- coordinate (a)
  ++(225:5) --
  ++(-45:5.1) coordinate (b);
\draw[shorten <= -10pt]
  (aux3) --
  (a) --
  (aux1);
\draw[opacity=0.6,titlepagecolor,shorten <= -10pt]
  (b) --
  ++(225:2.2) --
  ++(-45:2.2);
\end{scope}
\draw[titlepagecolor,line width=8pt,rounded corners=8pt,shorten <= -10pt]
  (aux4) --
  ++(225:0.8) --
  ++(-45:0.8);
\begin{scope}[titlepagecolor!70,line width=6pt,rounded corners=8pt]
\draw[shorten <= -10pt]
  (aux2) --
  ++(225:3) coordinate[pos=0.45] (c) --
  ++(-45:3.1);
\draw
  (aux2) --
  (c) --
  ++(135:2.5) --
  ++(45:2.5) --
  ++(-45:2.5) coordinate[pos=0.3] (d);   
\draw 
  (d) -- +(45:1);
\end{scope}
\end{tikzpicture}%
}


\usepackage{titlesec}

\newcommand\titlebar{%
\tikz[baseline,trim left=2.1cm,trim right=3cm] {
    \fill [RawSienna!15] (2.5cm,-1ex) rectangle (\textwidth+2.1cm,2.5ex);
    \node [
        fill=RawSienna!50!white,
        anchor= base east,
        rounded rectangle,
        minimum height=3.5ex] at (3cm,0) {
        \textbf{\arabic{chapter}.\thesection.}
    };
}%
}
\titleformat{\section}{\Large}{\titlebar}{0.1cm}{}
\renewcommand*{\thesection}{\arabic{section}}
